this is some ugly crap: 100% kludges, but no time for a rewrite yet

